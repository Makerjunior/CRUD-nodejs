const mysql=require('mysql');

class ClassCrud{

    constructor()
    {
        this.sql=mysql.createPool({
            user: "root",
            password: "",
            host: "localhost",ss
            database: "nodejs" 
        });
    }

    read(req,res)
    {
        if(!req.params.id){
            this.sql.getConnection(function(err,connection){
                connection.query("select * from user order by id asc",function(err,results,fields){
                    res.render('select',{data:results});
                });
            });
        }else{
            this.sql.getConnection(function(err,connection){
                sql.query("select * from user where id=? order by id asc",[req.params.id],function(err,results,fields){
                    res.render('select',{data:results});
                });
            });
        }
    }

    create(req,res)
    {
        this.sql.getConnection(function(err,connection){
            connection.query("insert into user values (?,?,?)",[req.body.id,req.body.name,req.body.age]);
            res.render('controllerForm',{name:req.body.name});
        });
    }

    deletes(req,res)
    {
        this.sql.getConnection(function(err,connection){
            connection.query("delete from user where id=?",[req.params.id]);
            res.render('deletar');
        });
    }

    update(req,res,controller=null)
    {
        if(controller==null){
            this.sql.getConnection(function(err,connection){
                connection.query("select * from user where id=?",[req.params.id],function(err,results,fields){
                    res.render('update',{id:req.params.id,name:results[0].name,age:results[0].age});
                });
            });
        }else{
            this.sql.getConnection(function(err,connection){
                connection.query("update user set name=?,age=? where id=?",[req.body.name,req.body.age,req.body.id]);
                res.render('controllerUpdate');
            });
        }
    }
}
module.exports=ClassCrud;